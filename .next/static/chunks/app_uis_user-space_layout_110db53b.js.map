{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Saas_MongoDB/mongo/app/uis/user-space/layout.js"],"sourcesContent":["'use client'\n\nimport { LocationOn as LocationOnIcon, MessageOutlined, PeopleOutline, CurrencyBitcoin, HomeOutlined, AccountCircle } from \"@mui/icons-material\";\nimport { AppBar, Box, Button, IconButton, Stack, Toolbar, Typography, Paper, BottomNavigation, BottomNavigationAction, Badge, Menu, MenuItem } from \"@mui/material\";\nimport NotificationsIcon from '@mui/icons-material/Notifications';\nimport { useRouter } from \"next/navigation\";\nimport { useState, useEffect, useCallback } from \"react\";\n\nexport default function RootLayout({ children }) {\n  const router = useRouter();\n\n  // Notifications / invitations state (improved)\n  const [anchorEl, setAnchorEl] = useState(null)\n  const [invitations, setInvitations] = useState([])\n  const [currentUserId, setCurrentUserId] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [processingId, setProcessingId] = useState(null)\n  const [value, setValue] = useState(0);\n\n  // ---------------------------------------------------------------------------\n  // Helpers: resolve current user id from server/local state\n  // ---------------------------------------------------------------------------\n  const resolveCurrentUserId = async () => {\n    try {\n      const res = await fetch('/api/auth/me')\n      if (res.ok) {\n        const payload = await res.json().catch(() => null)\n        const id = payload?.user?._id || payload?.user?.id || payload?.id || null\n        if (id) return id\n      }\n    } catch (e) {}\n    try {\n      const res2 = await fetch('/api/users?operation=get-current')\n      if (res2.ok) {\n        const p2 = await res2.json().catch(() => null)\n        const id2 = p2?.user?._id || p2?.user?.id || p2?.id || null\n        if (id2) return id2\n      }\n    } catch (e) {}\n    try {\n      if (typeof window !== 'undefined') {\n        const raw = localStorage.getItem('user')\n        if (raw) {\n          const parsed = JSON.parse(raw)\n          const lid = parsed?.id || parsed?._id || null\n          if (lid) return lid\n        }\n        const uid = localStorage.getItem('userId')\n        if (uid) return uid\n      }\n    } catch (e) {}\n    return null\n  }\n\n  // ---------------------------------------------------------------------------\n  // Invitations\n  // ---------------------------------------------------------------------------\n  const fetchInvitations = useCallback(async (uid) => {\n    if (!uid) return setInvitations([])\n    try {\n      const invRes = await fetch(`/api/friends?operation=get-invitations&userId=${encodeURIComponent(uid)}`)\n      if (!invRes.ok) {\n        const body = await invRes.json().catch(() => null)\n        console.warn('Failed to fetch invitations', body)\n        setInvitations([])\n        return\n      }\n      const payload = await invRes.json().catch(() => null)\n      setInvitations(payload?.invitations || [])\n    } catch (e) {\n      console.warn('fetchInvitations error', e)\n      setInvitations([])\n    }\n  }, [])\n\n  useEffect(() => {\n    let mounted = true\n    const boot = async () => {\n      setLoading(true)\n      const me = await resolveCurrentUserId()\n      if (!mounted) return\n      setCurrentUserId(me)\n      if (me) await fetchInvitations(me)\n      setLoading(false)\n    }\n    boot()\n    return () => { mounted = false }\n  }, [fetchInvitations])\n\n  // re-fetch when other parts of the app dispatch this event\n  useEffect(() => {\n    const handler = (e) => {\n      try {\n        if (currentUserId) fetchInvitations(currentUserId)\n      } catch (err) {\n        console.warn('friend-request-changed handler error', err)\n      }\n    }\n    window.addEventListener('friend-request-changed', handler)\n    return () => window.removeEventListener('friend-request-changed', handler)\n  }, [currentUserId, fetchInvitations])\n\n  const openMenu = (e) => setAnchorEl(e.currentTarget)\n  const closeMenu = () => setAnchorEl(null)\n\n  const respond = async (requestId, action) => {\n    setProcessingId(requestId)\n    try {\n      const res = await fetch('/api/friends', {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ requestId, action }),\n      })\n      const payload = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(payload?.error || 'Failed to update invitation')\n      setInvitations((prev) => prev.filter(i => String(i._id) !== String(requestId)))\n      try { window.dispatchEvent(new CustomEvent('friend-request-changed', { detail: { action, requestId } })) } catch (e) {}\n    } catch (err) {\n      alert(err.message || 'Failed to update invitation')\n    } finally {\n      setProcessingId(null)\n    }\n  }\n\n  // navigation helper\n  function loadScreen(event, screenURL) {\n    event?.preventDefault?.();\n    router.push(screenURL);\n  }\n\n  // ---------------------------------------------------------------------------\n  // Wallet disconnect helper (attempts to disconnect common providers + clear cache)\n  // ---------------------------------------------------------------------------\n  const signOutWallet = async () => {\n    try {\n      if (typeof window === 'undefined') return;\n      const eth = window.ethereum;\n      try { if (eth && typeof eth.disconnect === 'function') await eth.disconnect().catch(() => {}); } catch (e) {}\n      try { if (eth && typeof eth.close === 'function') await eth.close().catch(() => {}); } catch (e) {}\n      try { if (eth?.connector?.disconnect) await eth.connector.disconnect().catch(() => {}); } catch (e) {}\n      try { if (eth?.connector?.close) await eth.connector.close().catch(() => {}); } catch (e) {}\n      try { if (eth?.wc?.disconnect) await eth.wc.disconnect().catch(() => {}); } catch (e) {}\n    } catch (e) {\n      // ignore provider disconnect errors\n    }\n\n    // remove common cached keys used by WalletConnect / connectors / libs\n    try {\n      const cachedKeys = [\n        'walletconnect',\n        'WALLETCONNECT_DEEPLINK_CHOICE',\n        'WALLET_CONNECT_CACHED_PROVIDER',\n        'connectedWallet',\n        'connectorId',\n        'wagmi.wallet',\n        'web3auth',\n        'connectedWalletAddress'\n      ];\n      cachedKeys.forEach(k => { try { localStorage.removeItem(k); } catch (e) {} });\n    } catch (e) {}\n\n    try { window.dispatchEvent(new CustomEvent('wallet-disconnected')); } catch (e) {}\n  }\n\n  // ---------------------------------------------------------------------------\n  // local cleanup: remove wallet and tx keys from localStorage (all or for specific user)\n  // ---------------------------------------------------------------------------\n  function clearWalletLocalKeysForUser(optionalUserId) {\n    try {\n      if (typeof window === 'undefined') return;\n      for (let i = localStorage.length - 1; i >= 0; i--) {\n        const key = localStorage.key(i);\n        if (!key) continue;\n        if (optionalUserId) {\n          if (key.startsWith(`wallet:${optionalUserId}:`) || key.startsWith(`tx:${optionalUserId}`) || key.startsWith(`tx:`)) {\n            localStorage.removeItem(key);\n          }\n        } else {\n          if (key.startsWith('wallet:') || key.startsWith('tx:')) {\n            localStorage.removeItem(key);\n          }\n        }\n      }\n    } catch (e) {\n      // ignore storage errors\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n  // Logout handler â€” improved to clear client-side wallet artifacts and broadcast logout\n  // ---------------------------------------------------------------------------\n  async function handleLogout() {\n    // discover current user id (same fallback as earlier)\n    let userId = null\n    try {\n      const raw = typeof window !== 'undefined' ? localStorage.getItem('user') : null\n      if (raw) {\n        const parsed = JSON.parse(raw)\n        userId = parsed?.id ?? parsed?._id ?? null\n      }\n      if (!userId) {\n        const uid = typeof window !== 'undefined' ? localStorage.getItem('userId') : null\n        if (uid) userId = uid\n      }\n    } catch (e) {\n      userId = null\n    }\n\n    // attempt server logout (best-effort)\n    try {\n      if (userId) {\n        await fetch('/api/users?operation=logout', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ id: userId }),\n        }).catch(() => {})\n      } else {\n        await fetch('/api/auth/logout', { method: 'POST' }).catch(() => {})\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    // disconnect wallet providers and clear related cached keys\n    try {\n      await signOutWallet()\n    } catch (e) {}\n\n    // Clear local app state and wallet artifacts\n    try {\n      localStorage.removeItem('user')\n    } catch (e) {}\n    try {\n      localStorage.removeItem('userId')\n    } catch (e) {}\n    try {\n      sessionStorage.setItem('justLoggedOut', '1')\n    } catch (e) {}\n\n    // Clear wallet and tx keys (prefer per-user, if available)\n    try {\n      if (userId) clearWalletLocalKeysForUser(userId)\n      else clearWalletLocalKeysForUser()\n    } catch (e) {}\n\n    // Broadcast logout so other tabs / components can react\n    try {\n      localStorage.setItem('user-logout-ts', String(Date.now()));\n      // also dispatch a custom event for in-tab listeners\n      try { window.dispatchEvent(new CustomEvent('user-logout', { detail: { userId } })) } catch (e) {}\n    } catch (e) {}\n\n    // Redirect to public area\n    try {\n      window.location.replace('/uis')\n    } catch (e) {\n      try { router.replace('/uis') } catch (er) {}\n    }\n  }\n\n  // Expose sign-out helper and listen for external logout broadcasts\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    try { window.appSignOut = handleLogout } catch (e) {}\n\n    function onStorage(e) {\n      try {\n        if (!e) return;\n        // When another tab signals logout, clear local wallet and user keys locally\n        if (e.key === 'user-logout-ts') {\n          try { localStorage.removeItem('user'); } catch (er) {}\n          try { localStorage.removeItem('userId'); } catch (er) {}\n          clearWalletLocalKeysForUser();\n          setCurrentUserId(null);\n        }\n\n        // If userId was removed in another tab, clear wallet keys\n        if (e.key === 'userId') {\n          const oldVal = e.oldValue;\n          const newVal = e.newValue;\n          if (!newVal) {\n            // user cleared -> remove all wallet keys and reset currentUserId\n            clearWalletLocalKeysForUser();\n            setCurrentUserId(null);\n          } else if (oldVal && oldVal !== newVal) {\n            // user switched accounts in another tab: remove previous user's wallet keys and update currentUserId\n            try { clearWalletLocalKeysForUser(oldVal); } catch (er) {}\n            setCurrentUserId(newVal);\n            fetchInvitations(newVal);\n          } else if (!oldVal && newVal) {\n            // fresh login in another tab\n            setCurrentUserId(newVal);\n            fetchInvitations(newVal);\n          }\n        }\n\n        // If full user object changed (e.g. login), attempt to read and update currentUserId\n        if (e.key === 'user') {\n          try {\n            const parsed = e.newValue ? JSON.parse(e.newValue) : null;\n            const newId = parsed?.id || parsed?._id || null;\n            if (newId) {\n              setCurrentUserId(newId);\n              fetchInvitations(newId);\n            }\n            if (!e.newValue) {\n              // removed user\n              setCurrentUserId(null);\n            }\n          } catch (err) {}\n        }\n      } catch (err) {\n        // ignore\n      }\n    }\n\n    window.addEventListener('storage', onStorage)\n    return () => {\n      try { delete window.appSignOut } catch (e) {}\n      window.removeEventListener('storage', onStorage)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fetchInvitations])\n\n  // ---------------------------------------------------------------------------\n  // UI\n  // ---------------------------------------------------------------------------\n  return (\n    <Box sx={{ position: \"absolute\", top: 0, left: 0, bottom: 0, right: 0 }}>\n      <Box sx={{ position: \"relative\", top: 0, left: 0, bottom: 0, right: 0, display: 'flex', flexDirection: 'column', height: '100vh', width: '100%', overflow: 'hidden' }}>\n        {/* App Bar (minimal) */}\n        <Box>\n          <AppBar position=\"static\">\n            <Toolbar>\n              <Typography sx={{ fontSize: 18, fontWeight: 700, flexGrow: 1 }}>\n                Mini-Map\n              </Typography>\n              <Stack direction={\"row\"} spacing={1} alignItems=\"center\">\n                {/* Notifications */}\n                <Box>\n                  <IconButton onClick={openMenu} aria-label=\"notifications\" size=\"large\">\n                    <Badge badgeContent={invitations.length} color=\"error\">\n                      <NotificationsIcon />\n                    </Badge>\n                  </IconButton>\n\n                  <Menu anchorEl={anchorEl} open={Boolean(anchorEl)} onClose={closeMenu}>\n                    {loading && <MenuItem><Typography>Loading...</Typography></MenuItem>}\n                    {!loading && invitations.length === 0 && <MenuItem><Typography>No invitations</Typography></MenuItem>}\n                    {!loading && invitations.map((inv) => (\n                      <MenuItem key={inv._id} sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n                        <Typography variant=\"body2\">{inv.senderId?.pseudo || `${inv.senderId?.firstName || ''} ${inv.senderId?.lastName || ''}`}</Typography>\n                        <Box sx={{ display: 'flex', gap: 1 }}>\n                          <Button size=\"small\" variant=\"contained\" onClick={() => respond(inv._id, 'accept')} disabled={processingId === inv._id}>Accept</Button>\n                          <Button size=\"small\" variant=\"outlined\" onClick={() => respond(inv._id, 'refuse')} disabled={processingId === inv._id}>Refuse</Button>\n                        </Box>\n                      </MenuItem>\n                    ))}\n                    <MenuItem>\n                      <Button size=\"small\" onClick={() => { closeMenu(); router.push('/uis/user-space/all-users') }}>Browse users</Button>\n                    </MenuItem>\n                  </Menu>\n                </Box>\n\n                <IconButton onClick={(e) => loadScreen(e, \"/uis/user-space/profile\")} size=\"large\" edge=\"end\" sx={{ ml: 1 }}>\n                  {/* tiny profile button remains optional */}\n                </IconButton>\n\n                {/* Logout placed in User Space app bar */}\n                <Button onClick={handleLogout} sx={{ color: 'error.main', textTransform: 'none', fontWeight: 600 }}>\n                  Logout\n                </Button>\n              </Stack>\n            </Toolbar>\n          </AppBar>\n        </Box>\n\n        {/* Children */}\n        <Box sx={{ flex: 1, overflowY: 'auto', p: 1, '&::-webkit-scrollbar': { display: 'none' }, scrollbarWidth: 'none' }}>\n          {children}\n        </Box>\n\n        {/* Bottom Navigation - Maps, Chat, Crypto (currency) and Community */}\n        <Box>\n          <Paper elevation={2}>\n            <BottomNavigation showLabels value={value} onChange={(event, newValue) => setValue(newValue)}>\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/user-space\")} label=\"Home\" icon={<HomeOutlined />} />\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/user-space/maps\")} label=\"Maps\" icon={<LocationOnIcon />} />\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/user-space/all-users\")} label=\"Community\" icon={<PeopleOutline />} />\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/user-space/chat\")} label=\"Chat\" icon={<MessageOutlined />} />\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/user-space/profile\")} label=\"Profile\" icon={<AccountCircle />} />\n              <BottomNavigationAction onClick={(e) => loadScreen(e, \"/uis/crypto\")} label=\"Crypto\" icon={<CurrencyBitcoin />} />\n            </BottomNavigation>\n          </Paper>\n        </Box>\n      </Box>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}